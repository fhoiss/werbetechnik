<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookie Banner Super Debug</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        #debug-console {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 400px;
            max-height: 80vh;
            background: #000;
            color: #0f0;
            font-family: monospace;
            font-size: 12px;
            padding: 10px;
            overflow-y: auto;
            z-index: 99999;
            border: 2px solid #0f0;
            border-radius: 5px;
        }
        #debug-console .log { color: #0f0; }
        #debug-console .error { color: #f00; }
        #debug-console .warning { color: #ff0; }
        #debug-console .success { color: #0ff; }
        button { margin: 5px; }
    </style>
</head>
<body>
    <h1>Cookie Banner Super Debug</h1>

    <div style="padding: 20px; background: #f0f0f0; margin: 20px;">
        <h2>Manueller Test</h2>
        <button onclick="manualTest()">ðŸ” VOLLSTÃ„NDIGER TEST STARTEN</button>
        <button onclick="clearDebug()">ðŸ—‘ï¸ Console leeren</button>
        <button onclick="forceClickAll()">ðŸ‘† ALLE BUTTONS TESTEN</button>
    </div>

    <!-- Debug Console -->
    <div id="debug-console"></div>

    <!-- Header Placeholder -->
    <div id="header-placeholder"></div>

    <!-- Content -->
    <div style="padding: 20px;">
        <p>Scrolle nach unten, um den Cookie-Banner zu sehen...</p>
        <p>Ã–ffne auch die Browser-Konsole (F12) fÃ¼r weitere Details.</p>
    </div>

    <!-- Footer Placeholder -->
    <div id="footer-placeholder"></div>

    <!-- Original main.js wird NICHT geladen, wir machen alles manuell -->
    <script>
        // Debug Console Funktionen
        function debugLog(message, type = 'log') {
            const console_div = document.getElementById('debug-console');
            const time = new Date().toLocaleTimeString();
            console_div.innerHTML += `<div class="${type}">[${time}] ${message}</div>`;
            console_div.scrollTop = console_div.scrollHeight;
            console.log(`[${type}] ${message}`);
        }

        function clearDebug() {
            document.getElementById('debug-console').innerHTML = '';
        }

        // Footer laden
        debugLog('Starte Footer-Laden...', 'log');

        fetch('footer.html')
            .then(response => {
                if (!response.ok) throw new Error('Footer nicht gefunden');
                debugLog('âœ“ Footer fetch erfolgreich', 'success');
                return response.text();
            })
            .then(data => {
                document.getElementById('footer-placeholder').innerHTML = data;
                debugLog('âœ“ Footer HTML eingefÃ¼gt', 'success');

                // Warte kurz und dann Test
                setTimeout(() => {
                    debugLog('Starte automatischen Test in 500ms...', 'warning');
                    automaticTest();
                }, 500);
            })
            .catch(error => {
                debugLog('âœ— Fehler beim Footer-Laden: ' + error.message, 'error');
            });

        function automaticTest() {
            debugLog('=== AUTOMATISCHER TEST GESTARTET ===', 'warning');

            // 1. Elemente prÃ¼fen
            const banner = document.getElementById('cookie-banner');
            const modal = document.getElementById('cookie-modal');
            const acceptBtn = document.getElementById('cookie-accept-all');
            const declineBtn = document.getElementById('cookie-decline-all');
            const settingsBtn = document.getElementById('cookie-settings-open');
            const closeBtn = document.getElementById('cookie-modal-close');
            const saveBtn = document.getElementById('cookie-save-settings');

            debugLog('Banner Element: ' + (banner ? 'âœ“ GEFUNDEN' : 'âœ— FEHLT'), banner ? 'success' : 'error');
            debugLog('Modal Element: ' + (modal ? 'âœ“ GEFUNDEN' : 'âœ— FEHLT'), modal ? 'success' : 'error');
            debugLog('Accept Button: ' + (acceptBtn ? 'âœ“ GEFUNDEN' : 'âœ— FEHLT'), acceptBtn ? 'success' : 'error');
            debugLog('Decline Button: ' + (declineBtn ? 'âœ“ GEFUNDEN' : 'âœ— FEHLT'), declineBtn ? 'success' : 'error');
            debugLog('Settings Button: ' + (settingsBtn ? 'âœ“ GEFUNDEN' : 'âœ— FEHLT'), settingsBtn ? 'success' : 'error');
            debugLog('Close Button: ' + (closeBtn ? 'âœ“ GEFUNDEN' : 'âœ— FEHLT'), closeBtn ? 'success' : 'error');
            debugLog('Save Button: ' + (saveBtn ? 'âœ“ GEFUNDEN' : 'âœ— FEHLT'), saveBtn ? 'success' : 'error');

            // 2. Banner anzeigen
            if (banner) {
                banner.classList.add('active');
                debugLog('âœ“ Banner mit .active versehen', 'success');

                const styles = window.getComputedStyle(banner);
                debugLog('Banner display: ' + styles.display, 'log');
            }

            // 3. Event Listener MANUELL hinzufÃ¼gen und testen
            if (acceptBtn) {
                // Entferne alte Listener
                const newAcceptBtn = acceptBtn.cloneNode(true);
                acceptBtn.parentNode.replaceChild(newAcceptBtn, acceptBtn);

                newAcceptBtn.addEventListener('click', function(e) {
                    debugLog('ðŸŽ‰ ACCEPT BUTTON GEKLICKT!!!', 'success');
                    e.preventDefault();
                    alert('Accept Button funktioniert!');
                });
                debugLog('âœ“ Accept Event Listener hinzugefÃ¼gt', 'success');
            }

            if (declineBtn) {
                const newDeclineBtn = declineBtn.cloneNode(true);
                declineBtn.parentNode.replaceChild(newDeclineBtn, declineBtn);

                newDeclineBtn.addEventListener('click', function(e) {
                    debugLog('ðŸŽ‰ DECLINE BUTTON GEKLICKT!!!', 'success');
                    e.preventDefault();
                    alert('Decline Button funktioniert!');
                });
                debugLog('âœ“ Decline Event Listener hinzugefÃ¼gt', 'success');
            }

            if (settingsBtn) {
                const newSettingsBtn = settingsBtn.cloneNode(true);
                settingsBtn.parentNode.replaceChild(newSettingsBtn, settingsBtn);

                newSettingsBtn.addEventListener('click', function(e) {
                    debugLog('ðŸŽ‰ SETTINGS BUTTON GEKLICKT!!!', 'success');
                    e.preventDefault();

                    if (modal) {
                        modal.classList.add('active');
                        debugLog('âœ“ Modal geÃ¶ffnet', 'success');
                    } else {
                        debugLog('âœ— Modal nicht gefunden!', 'error');
                    }
                });
                debugLog('âœ“ Settings Event Listener hinzugefÃ¼gt', 'success');
            }

            if (closeBtn) {
                closeBtn.addEventListener('click', function(e) {
                    debugLog('ðŸŽ‰ CLOSE BUTTON GEKLICKT!!!', 'success');
                    if (modal) {
                        modal.classList.remove('active');
                        debugLog('âœ“ Modal geschlossen', 'success');
                    }
                });
                debugLog('âœ“ Close Event Listener hinzugefÃ¼gt', 'success');
            }

            debugLog('=== TEST ABGESCHLOSSEN ===', 'warning');
            debugLog('Versuche jetzt die Buttons im Cookie-Banner zu klicken!', 'warning');
        }

        function manualTest() {
            clearDebug();
            automaticTest();
        }

        function forceClickAll() {
            debugLog('=== SIMULIERE BUTTON-KLICKS ===', 'warning');

            const acceptBtn = document.getElementById('cookie-accept-all');
            const declineBtn = document.getElementById('cookie-decline-all');
            const settingsBtn = document.getElementById('cookie-settings-open');

            if (acceptBtn) {
                debugLog('Klicke Accept-Button...', 'log');
                acceptBtn.click();
            }

            setTimeout(() => {
                if (declineBtn) {
                    debugLog('Klicke Decline-Button...', 'log');
                    declineBtn.click();
                }
            }, 1000);

            setTimeout(() => {
                if (settingsBtn) {
                    debugLog('Klicke Settings-Button...', 'log');
                    settingsBtn.click();
                }
            }, 2000);
        }
    </script>
</body>
</html>
